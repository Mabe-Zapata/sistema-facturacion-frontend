@page "/dashboards/productos/crear"

@using System.ComponentModel.DataAnnotations

<h2 class="titulo-form">Registrar nuevo producto</h2>
<p class="descripcion-form">Completa los campos requeridos para añadir un nuevo producto al sistema.</p>

<EditForm Model="@producto" OnValidSubmit="@GuardarProducto">
    <DataAnnotationsValidator />
    <ValidationSummary />

    <div class="form-grid">
        <div class="campo">
            <label for="tipo">Tipo de producto</label>
            <InputText id="tipo" @bind-Value="producto.TipPro" class="form-control" />
            <ValidationMessage For="@(() => producto.TipPro)" />
        </div>

        <div class="campo">
            <label for="nombre">Nombre</label>
            <InputText id="nombre" @bind-Value="producto.NomPro" class="form-control" />
            <ValidationMessage For="@(() => producto.NomPro)" />
        </div>

        <div class="campo descripcion">
            <label for="descripcion">Descripción</label>
            <InputTextArea id="descripcion" @bind-Value="producto.DesPro" class="form-control" rows="3" />
            <ValidationMessage For="@(() => producto.DesPro)" />
        </div>

        <div class="campo">
            <label for="precio">Precio ($)</label>
            <InputNumber id="precio" @bind-Value="producto.PrePro" class="form-control" />
            <ValidationMessage For="@(() => producto.PrePro)" />
        </div>
    </div>

    <div class="acciones">
        <button type="submit" class="btn-guardar">💾 Guardar producto</button>
        <button type="button" class="btn-cancelar" @onclick="Cancelar">Cancelar</button>
    </div>
</EditForm>

@if (mensajeExito is not null)
{
    <div class="alerta-exito">@mensajeExito</div>
}

@code {
    private ProductoModel producto = new();

    private string? mensajeExito;

    private void GuardarProducto()
    {
        mensajeExito = $"✅ Producto '{producto.NomPro}' registrado exitosamente.";
        producto = new(); // limpia el formulario
    }

    private void Cancelar()
    {
        producto = new();
        mensajeExito = null;
    }

    public class ProductoModel
    {
        [Required(ErrorMessage = "El tipo es obligatorio.")]
        [StringLength(50, ErrorMessage = "Máximo 50 caracteres.")]
        public string? TipPro { get; set; }

        [Required(ErrorMessage = "El nombre es obligatorio.")]
        [StringLength(100, ErrorMessage = "Máximo 100 caracteres.")]
        public string? NomPro { get; set; }

        [Required(ErrorMessage = "La descripción es obligatoria.")]
        [StringLength(200, ErrorMessage = "Máximo 200 caracteres.")]
        public string? DesPro { get; set; }

        [Range(0.1, 9999.99, ErrorMessage = "Debe ingresar un precio válido (mayor que 0).")]
        public decimal PrePro { get; set; }
    }
}
