@using Microsoft.AspNetCore.Authorization
@using Microsoft.AspNetCore.Components
@attribute [AllowAnonymous]

<div class="position-relative">
    <input type="@(showPassword ? "text" : "password")"
           class="form-control form-control-lg"
           placeholder="Enter Password"
           value="@Password"
           @oninput="OnInput"
           @attributes="AdditionalAttributes" />

    <a href="javascript:void(0);"
       class="show-password-button text-muted"
       @onclick="ToggleVisibility">
        <i class="@(showPassword ? "ri-eye-off-line" : "ri-eye-line") align-middle"></i>
    </a>
</div>

@code {
    [Parameter] public string? Password { get; set; } = string.Empty;

    // Necesario para @bind-Password
    [Parameter] public EventCallback<string?> PasswordChanged { get; set; }

    [Parameter(CaptureUnmatchedValues = true)]
    public IDictionary<string, object>? AdditionalAttributes { get; set; }

    private bool showPassword;

    private async Task OnInput(ChangeEventArgs e)
    {
        Password = e.Value?.ToString() ?? string.Empty;   // Actualiza el estado interno
        await PasswordChanged.InvokeAsync(Password);       // Propaga al padre (EditForm)
    }

    private void ToggleVisibility() => showPassword = !showPassword;
}
